nohup: ignoring input
----------------------------------------ARGUMENTS----------------------------------------
data_path                                /root/autodl-tmp/poetry/pepler/data/TripAdvisor/reviews.pickle
index_dir                                /root/autodl-tmp/poetry/pepler/data/TripAdvisor/1
model_path                               /root/autodl-tmp/poetry/pepler/pe/tripadvisor/1/model.pt
lr                                       0.001
epochs                                   100
batch_size                               128
cuda                                     True
log_interval                             200
checkpoint                               /root/autodl-tmp/poetry/pepler/pe/tripadvisor/1/
outf                                     generated.txt
endure_times                             5
use_mf                                   True
words                                    20
----------------------------------------ARGUMENTS----------------------------------------
[2024-04-24 19:26:34.628416]: Loading data
[2024-04-24 19:29:11.459664]: epoch 1
/root/miniconda3/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py:202: UserWarning: where received a uint8 condition tensor. This behavior is deprecated and will be removed in a future version of PyTorch. Use a boolean condition instead. (Triggered internally at  ../aten/src/ATen/native/TensorCompare.cpp:328.)
  attn_weights = torch.where(causal_mask, attn_weights.to(attn_weights.dtype), mask_value)
[2024-04-24 19:29:30.918033]: text ppl 7.6679 | rating loss 0.2698 |   200/ 2001 batches
[2024-04-24 19:29:50.303904]: text ppl 7.8222 | rating loss 0.2701 |   400/ 2001 batches
[2024-04-24 19:30:09.710219]: text ppl 7.9981 | rating loss 0.2688 |   600/ 2001 batches
[2024-04-24 19:30:29.051359]: text ppl 8.1045 | rating loss 0.2586 |   800/ 2001 batches
[2024-04-24 19:30:48.444813]: text ppl 8.2892 | rating loss 0.2539 |  1000/ 2001 batches
[2024-04-24 19:31:07.887292]: text ppl 8.4320 | rating loss 0.2597 |  1200/ 2001 batches
[2024-04-24 19:31:27.333432]: text ppl 8.5635 | rating loss 0.2440 |  1400/ 2001 batches
[2024-04-24 19:31:46.842693]: text ppl 8.6554 | rating loss 0.2413 |  1600/ 2001 batches
[2024-04-24 19:32:06.342695]: text ppl 8.7159 | rating loss 0.2349 |  1800/ 2001 batches
[2024-04-24 19:32:25.948114]: text ppl 8.7610 | rating loss 0.2251 |  2000/ 2001 batches
[2024-04-24 19:32:25.984821]: text ppl 8.9908 | rating loss 0.1521 |  2001/ 2001 batches
[2024-04-24 19:32:33.285681]: text ppl 17.6819 | rating loss 2.3844 | valid loss 5.2569 on validation
weight[0]: 1.3103787899017334
weight[1]: 0.6290170550346375
[2024-04-24 19:32:34.187045]: epoch 2
[2024-04-24 19:32:53.979277]: text ppl 6.6121 | rating loss 0.5116 |   200/ 2001 batches
[2024-04-24 19:33:13.558062]: text ppl 7.0461 | rating loss 0.4901 |   400/ 2001 batches
[2024-04-24 19:33:33.065124]: text ppl 7.2975 | rating loss 0.4585 |   600/ 2001 batches
[2024-04-24 19:33:52.552774]: text ppl 7.4802 | rating loss 0.4519 |   800/ 2001 batches
[2024-04-24 19:34:12.050449]: text ppl 7.6012 | rating loss 0.4453 |  1000/ 2001 batches
[2024-04-24 19:34:31.527332]: text ppl 7.7582 | rating loss 0.4268 |  1200/ 2001 batches
[2024-04-24 19:34:50.986658]: text ppl 7.8710 | rating loss 0.4180 |  1400/ 2001 batches
[2024-04-24 19:35:10.457549]: text ppl 7.9810 | rating loss 0.4019 |  1600/ 2001 batches
[2024-04-24 19:35:29.936008]: text ppl 8.1188 | rating loss 0.3982 |  1800/ 2001 batches
[2024-04-24 19:35:49.394140]: text ppl 8.1558 | rating loss 0.3832 |  2000/ 2001 batches
[2024-04-24 19:35:49.423883]: text ppl 7.3576 | rating loss 0.2770 |  2001/ 2001 batches
[2024-04-24 19:35:56.687633]: text ppl 18.4399 | rating loss 2.1789 | valid loss 5.0934 on validation
weight[0]: 1.2947319746017456
weight[1]: 0.7327675819396973
[2024-04-24 19:35:57.595802]: epoch 3
[2024-04-24 19:36:17.184031]: text ppl 5.9631 | rating loss 0.5595 |   200/ 2001 batches
[2024-04-24 19:36:36.762703]: text ppl 6.3252 | rating loss 0.5525 |   400/ 2001 batches
[2024-04-24 19:36:56.303574]: text ppl 6.5213 | rating loss 0.5463 |   600/ 2001 batches
[2024-04-24 19:37:15.802351]: text ppl 6.7058 | rating loss 0.5501 |   800/ 2001 batches
[2024-04-24 19:37:35.264523]: text ppl 6.8368 | rating loss 0.5450 |  1000/ 2001 batches
[2024-04-24 19:37:54.730246]: text ppl 6.9607 | rating loss 0.5356 |  1200/ 2001 batches
[2024-04-24 19:38:14.233117]: text ppl 7.0508 | rating loss 0.5251 |  1400/ 2001 batches
[2024-04-24 19:38:33.714330]: text ppl 7.2293 | rating loss 0.5196 |  1600/ 2001 batches
[2024-04-24 19:38:53.183852]: text ppl 7.2945 | rating loss 0.5231 |  1800/ 2001 batches
[2024-04-24 19:39:12.637294]: text ppl 7.3798 | rating loss 0.5201 |  2000/ 2001 batches
[2024-04-24 19:39:12.670305]: text ppl 7.4056 | rating loss 0.3115 |  2001/ 2001 batches
[2024-04-24 19:39:19.943447]: text ppl 19.6772 | rating loss 1.9743 | valid loss 4.9538 on validation
weight[0]: 1.2739946842193604
weight[1]: 0.8072763085365295
[2024-04-24 19:39:20.870049]: epoch 4
[2024-04-24 19:39:40.450126]: text ppl 5.3295 | rating loss 0.3402 |   200/ 2001 batches
[2024-04-24 19:40:00.022135]: text ppl 5.6347 | rating loss 0.3243 |   400/ 2001 batches
[2024-04-24 19:40:19.585257]: text ppl 5.8702 | rating loss 0.3120 |   600/ 2001 batches
[2024-04-24 19:40:39.113707]: text ppl 6.0147 | rating loss 0.3088 |   800/ 2001 batches
[2024-04-24 19:40:58.663146]: text ppl 6.1562 | rating loss 0.3009 |  1000/ 2001 batches
[2024-04-24 19:41:18.224416]: text ppl 6.2757 | rating loss 0.2903 |  1200/ 2001 batches
[2024-04-24 19:41:37.772175]: text ppl 6.3717 | rating loss 0.2895 |  1400/ 2001 batches
[2024-04-24 19:41:57.314702]: text ppl 6.4695 | rating loss 0.2816 |  1600/ 2001 batches
[2024-04-24 19:42:16.923873]: text ppl 6.6101 | rating loss 0.2777 |  1800/ 2001 batches
[2024-04-24 19:42:36.529281]: text ppl 6.6942 | rating loss 0.2732 |  2000/ 2001 batches
[2024-04-24 19:42:36.561063]: text ppl 6.9750 | rating loss 0.3039 |  2001/ 2001 batches
[2024-04-24 19:42:43.839541]: text ppl 22.0119 | rating loss 1.7899 | valid loss 4.8815 on validation
weight[0]: 1.2497414350509644
weight[1]: 0.6695851683616638
[2024-04-24 19:42:44.754664]: epoch 5
[2024-04-24 19:43:04.338879]: text ppl 4.7900 | rating loss 0.4833 |   200/ 2001 batches
[2024-04-24 19:43:23.799643]: text ppl 5.0833 | rating loss 0.4878 |   400/ 2001 batches
[2024-04-24 19:43:43.266160]: text ppl 5.2883 | rating loss 0.4795 |   600/ 2001 batches
[2024-04-24 19:44:02.749313]: text ppl 5.4265 | rating loss 0.4673 |   800/ 2001 batches
[2024-04-24 19:44:22.360778]: text ppl 5.5533 | rating loss 0.4660 |  1000/ 2001 batches
[2024-04-24 19:44:41.944625]: text ppl 5.6812 | rating loss 0.4592 |  1200/ 2001 batches
[2024-04-24 19:45:01.464465]: text ppl 5.7831 | rating loss 0.4483 |  1400/ 2001 batches
[2024-04-24 19:45:21.117000]: text ppl 5.8386 | rating loss 0.4429 |  1600/ 2001 batches
[2024-04-24 19:45:40.649771]: text ppl 5.9525 | rating loss 0.4355 |  1800/ 2001 batches
[2024-04-24 19:46:00.228003]: text ppl 6.0479 | rating loss 0.4348 |  2000/ 2001 batches
[2024-04-24 19:46:00.259578]: text ppl 6.4072 | rating loss 0.4070 |  2001/ 2001 batches
[2024-04-24 19:46:07.538527]: text ppl 23.6369 | rating loss 1.6421 | valid loss 4.8049 on validation
weight[0]: 1.2246938943862915
weight[1]: 0.7659162878990173
[2024-04-24 19:46:08.620580]: epoch 6
[2024-04-24 19:46:28.433349]: text ppl 4.3100 | rating loss 0.2900 |   200/ 2001 batches
[2024-04-24 19:46:48.083230]: text ppl 4.6115 | rating loss 0.2787 |   400/ 2001 batches
[2024-04-24 19:47:07.696867]: text ppl 4.7942 | rating loss 0.2736 |   600/ 2001 batches
[2024-04-24 19:47:27.093073]: text ppl 4.9359 | rating loss 0.2706 |   800/ 2001 batches
[2024-04-24 19:47:46.448410]: text ppl 5.0618 | rating loss 0.2572 |  1000/ 2001 batches
[2024-04-24 19:48:05.844899]: text ppl 5.1618 | rating loss 0.2643 |  1200/ 2001 batches
[2024-04-24 19:48:25.329758]: text ppl 5.2471 | rating loss 0.2559 |  1400/ 2001 batches
[2024-04-24 19:48:44.704111]: text ppl 5.3629 | rating loss 0.2511 |  1600/ 2001 batches
[2024-04-24 19:49:04.131841]: text ppl 5.4667 | rating loss 0.2523 |  1800/ 2001 batches
[2024-04-24 19:49:23.564427]: text ppl 5.5326 | rating loss 0.2451 |  2000/ 2001 batches
[2024-04-24 19:49:23.595621]: text ppl 5.5234 | rating loss 0.2391 |  2001/ 2001 batches
[2024-04-24 19:49:30.871253]: text ppl 26.8037 | rating loss 1.5196 | valid loss 4.8081 on validation
weight[0]: 1.2043585777282715
weight[1]: 0.6415900588035583
[2024-04-24 19:49:30.871515]: Endured 1 time(s)
[2024-04-24 19:49:30.871545]: epoch 7
[2024-04-24 19:49:50.587298]: text ppl 3.9627 | rating loss 0.4085 |   200/ 2001 batches
[2024-04-24 19:50:10.157974]: text ppl 4.2245 | rating loss 0.4093 |   400/ 2001 batches
[2024-04-24 19:50:29.611611]: text ppl 4.3879 | rating loss 0.3949 |   600/ 2001 batches
[2024-04-24 19:50:49.018754]: text ppl 4.5320 | rating loss 0.3933 |   800/ 2001 batches
[2024-04-24 19:51:08.506122]: text ppl 4.6307 | rating loss 0.3874 |  1000/ 2001 batches
[2024-04-24 19:51:27.962932]: text ppl 4.7466 | rating loss 0.3692 |  1200/ 2001 batches
[2024-04-24 19:51:47.442247]: text ppl 4.8447 | rating loss 0.3635 |  1400/ 2001 batches
[2024-04-24 19:52:06.899069]: text ppl 4.9235 | rating loss 0.3579 |  1600/ 2001 batches
[2024-04-24 19:52:26.402215]: text ppl 5.0022 | rating loss 0.3531 |  1800/ 2001 batches
[2024-04-24 19:52:45.954564]: text ppl 5.0844 | rating loss 0.3537 |  2000/ 2001 batches
[2024-04-24 19:52:45.987828]: text ppl 5.8450 | rating loss 0.3662 |  2001/ 2001 batches
[2024-04-24 19:52:53.263291]: text ppl 29.7773 | rating loss 1.3911 | valid loss 4.7848 on validation
weight[0]: 1.1829285621643066
weight[1]: 0.7163088917732239
[2024-04-24 19:52:54.209696]: epoch 8
[2024-04-24 19:53:13.874490]: text ppl 3.6447 | rating loss 0.2708 |   200/ 2001 batches
[2024-04-24 19:53:33.429392]: text ppl 3.8776 | rating loss 0.2620 |   400/ 2001 batches
[2024-04-24 19:53:52.946247]: text ppl 4.0619 | rating loss 0.2573 |   600/ 2001 batches
[2024-04-24 19:54:12.494215]: text ppl 4.1638 | rating loss 0.2473 |   800/ 2001 batches
[2024-04-24 19:54:32.080793]: text ppl 4.2906 | rating loss 0.2499 |  1000/ 2001 batches
[2024-04-24 19:54:51.554259]: text ppl 4.3826 | rating loss 0.2376 |  1200/ 2001 batches
[2024-04-24 19:55:10.989687]: text ppl 4.4681 | rating loss 0.2392 |  1400/ 2001 batches
[2024-04-24 19:55:30.446393]: text ppl 4.5610 | rating loss 0.2343 |  1600/ 2001 batches
[2024-04-24 19:55:49.974328]: text ppl 4.6698 | rating loss 0.2356 |  1800/ 2001 batches
[2024-04-24 19:56:09.473552]: text ppl 4.7405 | rating loss 0.2355 |  2000/ 2001 batches
[2024-04-24 19:56:09.504791]: text ppl 4.3919 | rating loss 0.1936 |  2001/ 2001 batches
[2024-04-24 19:56:16.775342]: text ppl 32.1226 | rating loss 1.3116 | valid loss 4.7812 on validation
weight[0]: 1.1628968715667725
weight[1]: 0.6372620463371277
[2024-04-24 19:56:17.694590]: epoch 9
[2024-04-24 19:56:37.302673]: text ppl 3.4127 | rating loss 0.3422 |   200/ 2001 batches
[2024-04-24 19:56:56.809588]: text ppl 3.6315 | rating loss 0.3378 |   400/ 2001 batches
[2024-04-24 19:57:16.445602]: text ppl 3.7565 | rating loss 0.3276 |   600/ 2001 batches
[2024-04-24 19:57:36.055612]: text ppl 3.8794 | rating loss 0.3209 |   800/ 2001 batches
[2024-04-24 19:57:55.647369]: text ppl 3.9878 | rating loss 0.3164 |  1000/ 2001 batches
[2024-04-24 19:58:15.052359]: text ppl 4.0873 | rating loss 0.3055 |  1200/ 2001 batches
[2024-04-24 19:58:34.477615]: text ppl 4.1632 | rating loss 0.3008 |  1400/ 2001 batches
[2024-04-24 19:58:53.879591]: text ppl 4.2379 | rating loss 0.2935 |  1600/ 2001 batches
[2024-04-24 19:59:13.304013]: text ppl 4.3299 | rating loss 0.2898 |  1800/ 2001 batches
[2024-04-24 19:59:32.686214]: text ppl 4.4117 | rating loss 0.2863 |  2000/ 2001 batches
[2024-04-24 19:59:32.716715]: text ppl 4.3287 | rating loss 0.2704 |  2001/ 2001 batches
[2024-04-24 19:59:39.971037]: text ppl 35.1932 | rating loss 1.2116 | valid loss 4.7724 on validation
weight[0]: 1.1518712043762207
weight[1]: 0.6748839616775513
[2024-04-24 19:59:40.905019]: epoch 10
[2024-04-24 20:00:00.455423]: text ppl 3.1786 | rating loss 0.2602 |   200/ 2001 batches
[2024-04-24 20:00:19.954199]: text ppl 3.3991 | rating loss 0.2490 |   400/ 2001 batches
[2024-04-24 20:00:39.470423]: text ppl 3.5321 | rating loss 0.2462 |   600/ 2001 batches
[2024-04-24 20:00:59.068514]: text ppl 3.6384 | rating loss 0.2360 |   800/ 2001 batches
[2024-04-24 20:01:18.581714]: text ppl 3.7399 | rating loss 0.2358 |  1000/ 2001 batches
[2024-04-24 20:01:38.007105]: text ppl 3.8143 | rating loss 0.2335 |  1200/ 2001 batches
[2024-04-24 20:01:57.480406]: text ppl 3.9268 | rating loss 0.2302 |  1400/ 2001 batches
[2024-04-24 20:02:16.952094]: text ppl 3.9789 | rating loss 0.2275 |  1600/ 2001 batches
[2024-04-24 20:02:36.391239]: text ppl 4.0745 | rating loss 0.2228 |  1800/ 2001 batches
[2024-04-24 20:02:55.885605]: text ppl 4.1349 | rating loss 0.2216 |  2000/ 2001 batches
[2024-04-24 20:02:55.917749]: text ppl 4.1849 | rating loss 0.1739 |  2001/ 2001 batches
[2024-04-24 20:03:03.197975]: text ppl 37.3983 | rating loss 1.1554 | valid loss 4.7771 on validation
weight[0]: 1.126278042793274
weight[1]: 0.6235343813896179
[2024-04-24 20:03:03.198181]: Endured 2 time(s)
[2024-04-24 20:03:03.198196]: epoch 11
[2024-04-24 20:03:22.743360]: text ppl 3.0108 | rating loss 0.2978 |   200/ 2001 batches
[2024-04-24 20:03:42.310450]: text ppl 3.2115 | rating loss 0.2842 |   400/ 2001 batches
[2024-04-24 20:04:01.896872]: text ppl 3.3324 | rating loss 0.2807 |   600/ 2001 batches
[2024-04-24 20:04:21.620075]: text ppl 3.4358 | rating loss 0.2733 |   800/ 2001 batches
[2024-04-24 20:04:41.341735]: text ppl 3.5141 | rating loss 0.2675 |  1000/ 2001 batches
[2024-04-24 20:05:01.044471]: text ppl 3.6160 | rating loss 0.2596 |  1200/ 2001 batches
[2024-04-24 20:05:20.707094]: text ppl 3.6784 | rating loss 0.2551 |  1400/ 2001 batches
[2024-04-24 20:05:40.412901]: text ppl 3.7761 | rating loss 0.2486 |  1600/ 2001 batches
[2024-04-24 20:06:00.157069]: text ppl 3.8200 | rating loss 0.2420 |  1800/ 2001 batches
[2024-04-24 20:06:19.785550]: text ppl 3.9069 | rating loss 0.2450 |  2000/ 2001 batches
[2024-04-24 20:06:19.820349]: text ppl 3.5468 | rating loss 0.2083 |  2001/ 2001 batches
[2024-04-24 20:06:27.155393]: text ppl 42.8295 | rating loss 1.0895 | valid loss 4.8468 on validation
weight[0]: 1.1147475242614746
weight[1]: 0.6379302144050598
[2024-04-24 20:06:27.155635]: Endured 3 time(s)
[2024-04-24 20:06:27.155650]: epoch 12
[2024-04-24 20:06:47.023790]: text ppl 2.8461 | rating loss 0.2484 |   200/ 2001 batches
[2024-04-24 20:07:06.738148]: text ppl 3.0357 | rating loss 0.2425 |   400/ 2001 batches
[2024-04-24 20:07:26.460362]: text ppl 3.1476 | rating loss 0.2349 |   600/ 2001 batches
[2024-04-24 20:07:46.161389]: text ppl 3.2581 | rating loss 0.2322 |   800/ 2001 batches
[2024-04-24 20:08:05.809465]: text ppl 3.3351 | rating loss 0.2249 |  1000/ 2001 batches
[2024-04-24 20:08:25.511354]: text ppl 3.4227 | rating loss 0.2261 |  1200/ 2001 batches
[2024-04-24 20:08:45.179657]: text ppl 3.4906 | rating loss 0.2202 |  1400/ 2001 batches
[2024-04-24 20:09:04.994736]: text ppl 3.5721 | rating loss 0.2158 |  1600/ 2001 batches
[2024-04-24 20:09:24.726771]: text ppl 3.6359 | rating loss 0.2137 |  1800/ 2001 batches
[2024-04-24 20:09:44.463228]: text ppl 3.7055 | rating loss 0.2102 |  2000/ 2001 batches
[2024-04-24 20:09:44.497620]: text ppl 3.3240 | rating loss 0.1911 |  2001/ 2001 batches
[2024-04-24 20:09:51.835439]: text ppl 45.9228 | rating loss 1.0561 | valid loss 4.8831 on validation
weight[0]: 1.0941399335861206
weight[1]: 0.620769739151001
[2024-04-24 20:09:51.835704]: Endured 4 time(s)
[2024-04-24 20:09:51.835727]: epoch 13
[2024-04-24 20:10:11.749815]: text ppl 2.7247 | rating loss 0.2645 |   200/ 2001 batches
[2024-04-24 20:10:31.471916]: text ppl 2.8766 | rating loss 0.2564 |   400/ 2001 batches
[2024-04-24 20:10:51.243221]: text ppl 3.0011 | rating loss 0.2506 |   600/ 2001 batches
[2024-04-24 20:11:11.021726]: text ppl 3.1015 | rating loss 0.2432 |   800/ 2001 batches
[2024-04-24 20:11:30.778732]: text ppl 3.1782 | rating loss 0.2336 |  1000/ 2001 batches
[2024-04-24 20:11:50.484698]: text ppl 3.2482 | rating loss 0.2287 |  1200/ 2001 batches
[2024-04-24 20:12:10.191058]: text ppl 3.3099 | rating loss 0.2305 |  1400/ 2001 batches
[2024-04-24 20:12:29.921353]: text ppl 3.3980 | rating loss 0.2191 |  1600/ 2001 batches
[2024-04-24 20:12:49.680160]: text ppl 3.4484 | rating loss 0.2213 |  1800/ 2001 batches
[2024-04-24 20:13:09.374429]: text ppl 3.5382 | rating loss 0.2127 |  2000/ 2001 batches
[2024-04-24 20:13:09.407893]: text ppl 3.6058 | rating loss 0.1367 |  2001/ 2001 batches
[2024-04-24 20:13:16.711097]: text ppl 48.0867 | rating loss 1.0189 | valid loss 4.8919 on validation
weight[0]: 1.0860426425933838
weight[1]: 0.6195295453071594
[2024-04-24 20:13:16.711378]: Endured 5 time(s)
[2024-04-24 20:13:16.711398]: Cannot endure it anymore | Exiting from early stop
=========================================================================================
[2024-04-24 20:13:24.229722]: text ppl 35.6403 | rating loss 1.2188 on test | End of training
[2024-04-24 20:13:24.229828]: Generating text
[2024-04-24 20:14:41.261270]: RMSE  1.1036
[2024-04-24 20:14:41.269354]: MAE  0.9114
[2024-04-24 20:14:58.174972]: BLEU-1 14.8138
[2024-04-24 20:15:00.969629]: BLEU-4  0.9845
[2024-04-24 20:16:09.175693]: USR  0.6249 | USN   19998
[2024-04-24 20:20:05.116620]: DIV  2.1478
[2024-04-24 20:20:05.575941]: FCR  0.5276
[2024-04-24 20:20:05.596852]: FMR  0.0669
[2024-04-24 20:20:09.870280]: rouge_1/f_score 15.5598
[2024-04-24 20:20:09.870424]: rouge_1/r_score 15.2043
[2024-04-24 20:20:09.870435]: rouge_1/p_score 18.6814
[2024-04-24 20:20:09.870444]: rouge_2/f_score  1.9441
[2024-04-24 20:20:09.870451]: rouge_2/r_score  1.9878
[2024-04-24 20:20:09.870458]: rouge_2/p_score  2.2875
[2024-04-24 20:20:09.870465]: rouge_l/f_score 12.2002
[2024-04-24 20:20:09.870472]: rouge_l/r_score 13.8130
[2024-04-24 20:20:09.870479]: rouge_l/p_score 16.1596
[2024-04-24 20:20:09.896776]: Generated text saved to (/root/autodl-tmp/poetry/pepler/pe/tripadvisor/1/generated.txt)
