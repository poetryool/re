----------------------------------------ARGUMENTS----------------------------------------
data_path                                /root/autodl-tmp/poetry/pepler/data/TripAdvisor/reviews.pickle
index_dir                                /root/autodl-tmp/poetry/pepler/data/TripAdvisor/3
model_path                               /root/autodl-tmp/poetry/pepler/pe/tripadvisor/3/model.pt
lr                                       0.001
epochs                                   100
batch_size                               128
cuda                                     True
log_interval                             200
checkpoint                               /root/autodl-tmp/poetry/pepler/pe/tripadvisor/3/
outf                                     generated.txt
endure_times                             5
use_mf                                   True
words                                    20
----------------------------------------ARGUMENTS----------------------------------------
[2024-04-24 21:13:08.804728]: Loading data
[2024-04-24 21:15:47.514522]: epoch 1
/root/miniconda3/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py:202: UserWarning: where received a uint8 condition tensor. This behavior is deprecated and will be removed in a future version of PyTorch. Use a boolean condition instead. (Triggered internally at  ../aten/src/ATen/native/TensorCompare.cpp:328.)
  attn_weights = torch.where(causal_mask, attn_weights.to(attn_weights.dtype), mask_value)
[2024-04-24 21:16:07.179206]: text ppl 7.8402 | rating loss 0.2858 |   200/ 2001 batches
[2024-04-24 21:16:26.811657]: text ppl 8.0409 | rating loss 0.2856 |   400/ 2001 batches
[2024-04-24 21:16:46.551271]: text ppl 8.2001 | rating loss 0.2851 |   600/ 2001 batches
[2024-04-24 21:17:06.331603]: text ppl 8.3203 | rating loss 0.2734 |   800/ 2001 batches
[2024-04-24 21:17:26.121167]: text ppl 8.4835 | rating loss 0.2697 |  1000/ 2001 batches
[2024-04-24 21:17:45.817094]: text ppl 8.6391 | rating loss 0.2622 |  1200/ 2001 batches
[2024-04-24 21:18:05.474128]: text ppl 8.7617 | rating loss 0.2580 |  1400/ 2001 batches
[2024-04-24 21:18:25.220394]: text ppl 8.8756 | rating loss 0.2484 |  1600/ 2001 batches
[2024-04-24 21:18:44.960865]: text ppl 8.9227 | rating loss 0.2434 |  1800/ 2001 batches
[2024-04-24 21:19:04.640372]: text ppl 8.9142 | rating loss 0.2365 |  2000/ 2001 batches
[2024-04-24 21:19:04.681762]: text ppl 10.4800 | rating loss 0.2927 |  2001/ 2001 batches
[2024-04-24 21:19:11.885918]: text ppl 17.4991 | rating loss 2.4876 | valid loss 5.3498 on validation
weight[0]: 1.3153308629989624
weight[1]: 0.6365861296653748
[2024-04-24 21:19:12.849133]: epoch 2
[2024-04-24 21:19:32.817109]: text ppl 6.7579 | rating loss 0.5256 |   200/ 2001 batches
[2024-04-24 21:19:52.612598]: text ppl 7.2196 | rating loss 0.4967 |   400/ 2001 batches
[2024-04-24 21:20:12.328557]: text ppl 7.4461 | rating loss 0.4893 |   600/ 2001 batches
[2024-04-24 21:20:32.049329]: text ppl 7.6062 | rating loss 0.4703 |   800/ 2001 batches
[2024-04-24 21:20:51.700830]: text ppl 7.7825 | rating loss 0.4668 |  1000/ 2001 batches
[2024-04-24 21:21:11.429465]: text ppl 7.8748 | rating loss 0.4613 |  1200/ 2001 batches
[2024-04-24 21:21:31.074907]: text ppl 8.0199 | rating loss 0.4476 |  1400/ 2001 batches
[2024-04-24 21:21:50.796843]: text ppl 8.0453 | rating loss 0.4429 |  1600/ 2001 batches
[2024-04-24 21:22:10.393530]: text ppl 8.1805 | rating loss 0.4299 |  1800/ 2001 batches
[2024-04-24 21:22:30.037641]: text ppl 8.2842 | rating loss 0.4213 |  2000/ 2001 batches
[2024-04-24 21:22:30.070581]: text ppl 6.0440 | rating loss 0.3157 |  2001/ 2001 batches
[2024-04-24 21:22:37.222705]: text ppl 18.3560 | rating loss 2.1654 | valid loss 5.0754 on validation
weight[0]: 1.2980023622512817
weight[1]: 0.7531852722167969
[2024-04-24 21:22:38.205294]: epoch 3
[2024-04-24 21:22:58.036435]: text ppl 6.0297 | rating loss 0.5743 |   200/ 2001 batches
[2024-04-24 21:23:17.726016]: text ppl 6.3814 | rating loss 0.5755 |   400/ 2001 batches
[2024-04-24 21:23:37.346615]: text ppl 6.6100 | rating loss 0.5605 |   600/ 2001 batches
[2024-04-24 21:23:57.108359]: text ppl 6.7827 | rating loss 0.5658 |   800/ 2001 batches
[2024-04-24 21:24:16.907153]: text ppl 6.9028 | rating loss 0.5654 |  1000/ 2001 batches
[2024-04-24 21:24:36.564399]: text ppl 7.0200 | rating loss 0.5573 |  1200/ 2001 batches
[2024-04-24 21:24:56.168670]: text ppl 7.1375 | rating loss 0.5522 |  1400/ 2001 batches
[2024-04-24 21:25:15.798582]: text ppl 7.2289 | rating loss 0.5443 |  1600/ 2001 batches
[2024-04-24 21:25:35.370456]: text ppl 7.3269 | rating loss 0.5366 |  1800/ 2001 batches
[2024-04-24 21:25:54.815327]: text ppl 7.4002 | rating loss 0.5471 |  2000/ 2001 batches
[2024-04-24 21:25:54.847169]: text ppl 7.1919 | rating loss 0.6660 |  2001/ 2001 batches
[2024-04-24 21:26:02.005973]: text ppl 19.8357 | rating loss 2.0268 | valid loss 5.0143 on validation
weight[0]: 1.2759209871292114
weight[1]: 0.8216026425361633
[2024-04-24 21:26:02.933266]: epoch 4
[2024-04-24 21:26:22.663381]: text ppl 5.3274 | rating loss 0.3764 |   200/ 2001 batches
[2024-04-24 21:26:42.233607]: text ppl 5.6783 | rating loss 0.3634 |   400/ 2001 batches
[2024-04-24 21:27:01.793155]: text ppl 5.8937 | rating loss 0.3526 |   600/ 2001 batches
[2024-04-24 21:27:21.434651]: text ppl 6.0246 | rating loss 0.3393 |   800/ 2001 batches
[2024-04-24 21:27:41.211505]: text ppl 6.1390 | rating loss 0.3322 |  1000/ 2001 batches
[2024-04-24 21:28:00.858957]: text ppl 6.2643 | rating loss 0.3267 |  1200/ 2001 batches
[2024-04-24 21:28:20.609442]: text ppl 6.3496 | rating loss 0.3206 |  1400/ 2001 batches
[2024-04-24 21:28:40.361999]: text ppl 6.4596 | rating loss 0.3166 |  1600/ 2001 batches
[2024-04-24 21:29:00.049405]: text ppl 6.5320 | rating loss 0.3143 |  1800/ 2001 batches
[2024-04-24 21:29:19.812430]: text ppl 6.6016 | rating loss 0.3126 |  2000/ 2001 batches
[2024-04-24 21:29:19.845943]: text ppl 6.5229 | rating loss 0.2026 |  2001/ 2001 batches
[2024-04-24 21:29:27.005927]: text ppl 21.9240 | rating loss 1.8683 | valid loss 4.9559 on validation
weight[0]: 1.247178554534912
weight[1]: 0.6906485557556152
[2024-04-24 21:29:27.971320]: epoch 5
[2024-04-24 21:29:47.885372]: text ppl 4.7598 | rating loss 0.5288 |   200/ 2001 batches
[2024-04-24 21:30:07.538968]: text ppl 5.0621 | rating loss 0.5252 |   400/ 2001 batches
[2024-04-24 21:30:27.261096]: text ppl 5.2210 | rating loss 0.5189 |   600/ 2001 batches
[2024-04-24 21:30:46.949028]: text ppl 5.3595 | rating loss 0.5056 |   800/ 2001 batches
[2024-04-24 21:31:06.645132]: text ppl 5.4759 | rating loss 0.5047 |  1000/ 2001 batches
[2024-04-24 21:31:26.321425]: text ppl 5.5845 | rating loss 0.4944 |  1200/ 2001 batches
[2024-04-24 21:31:46.088171]: text ppl 5.6787 | rating loss 0.4897 |  1400/ 2001 batches
[2024-04-24 21:32:05.669608]: text ppl 5.7855 | rating loss 0.4887 |  1600/ 2001 batches
[2024-04-24 21:32:25.241168]: text ppl 5.8570 | rating loss 0.4692 |  1800/ 2001 batches
[2024-04-24 21:32:44.971202]: text ppl 5.9183 | rating loss 0.4756 |  2000/ 2001 batches
[2024-04-24 21:32:45.004598]: text ppl 6.2048 | rating loss 0.4197 |  2001/ 2001 batches
[2024-04-24 21:32:52.163506]: text ppl 24.2693 | rating loss 1.7392 | valid loss 4.9284 on validation
weight[0]: 1.2189140319824219
weight[1]: 0.7850871086120605
[2024-04-24 21:32:53.094764]: epoch 6
[2024-04-24 21:33:12.886155]: text ppl 4.2528 | rating loss 0.3219 |   200/ 2001 batches
[2024-04-24 21:33:32.453150]: text ppl 4.5222 | rating loss 0.3084 |   400/ 2001 batches
[2024-04-24 21:33:52.033458]: text ppl 4.6915 | rating loss 0.3005 |   600/ 2001 batches
[2024-04-24 21:34:11.632004]: text ppl 4.8272 | rating loss 0.2915 |   800/ 2001 batches
[2024-04-24 21:34:31.201924]: text ppl 4.9286 | rating loss 0.2933 |  1000/ 2001 batches
[2024-04-24 21:34:50.986803]: text ppl 5.0633 | rating loss 0.2925 |  1200/ 2001 batches
[2024-04-24 21:35:10.745186]: text ppl 5.1295 | rating loss 0.2777 |  1400/ 2001 batches
[2024-04-24 21:35:30.538811]: text ppl 5.2052 | rating loss 0.2805 |  1600/ 2001 batches
[2024-04-24 21:35:50.312016]: text ppl 5.2981 | rating loss 0.2754 |  1800/ 2001 batches
[2024-04-24 21:36:10.140410]: text ppl 5.3599 | rating loss 0.2725 |  2000/ 2001 batches
[2024-04-24 21:36:10.172001]: text ppl 5.6601 | rating loss 0.3747 |  2001/ 2001 batches
[2024-04-24 21:36:17.341986]: text ppl 27.6480 | rating loss 1.6284 | valid loss 4.9480 on validation
weight[0]: 1.1980050802230835
weight[1]: 0.6665540933609009
[2024-04-24 21:36:17.342199]: Endured 1 time(s)
[2024-04-24 21:36:17.342225]: epoch 7
[2024-04-24 21:36:37.181742]: text ppl 3.8739 | rating loss 0.4611 |   200/ 2001 batches
[2024-04-24 21:36:56.715340]: text ppl 4.0964 | rating loss 0.4543 |   400/ 2001 batches
[2024-04-24 21:37:16.304866]: text ppl 4.2645 | rating loss 0.4568 |   600/ 2001 batches
[2024-04-24 21:37:35.914192]: text ppl 4.3890 | rating loss 0.4463 |   800/ 2001 batches
[2024-04-24 21:37:55.563205]: text ppl 4.4664 | rating loss 0.4307 |  1000/ 2001 batches
[2024-04-24 21:38:15.142605]: text ppl 4.5838 | rating loss 0.4265 |  1200/ 2001 batches
[2024-04-24 21:38:34.905903]: text ppl 4.6522 | rating loss 0.4198 |  1400/ 2001 batches
[2024-04-24 21:38:54.548472]: text ppl 4.7282 | rating loss 0.4133 |  1600/ 2001 batches
[2024-04-24 21:39:14.150880]: text ppl 4.8152 | rating loss 0.4044 |  1800/ 2001 batches
[2024-04-24 21:39:33.773238]: text ppl 4.8787 | rating loss 0.4043 |  2000/ 2001 batches
[2024-04-24 21:39:33.805560]: text ppl 4.9887 | rating loss 0.5871 |  2001/ 2001 batches
[2024-04-24 21:39:40.964540]: text ppl 30.5992 | rating loss 1.5095 | valid loss 4.9305 on validation
weight[0]: 1.1733852624893188
weight[1]: 0.7490646243095398
[2024-04-24 21:39:40.964733]: Endured 2 time(s)
[2024-04-24 21:39:40.964748]: epoch 8
[2024-04-24 21:40:00.739275]: text ppl 3.5412 | rating loss 0.2947 |   200/ 2001 batches
[2024-04-24 21:40:20.362194]: text ppl 3.7649 | rating loss 0.2825 |   400/ 2001 batches
[2024-04-24 21:40:39.971729]: text ppl 3.8907 | rating loss 0.2802 |   600/ 2001 batches
[2024-04-24 21:40:59.578337]: text ppl 3.9986 | rating loss 0.2685 |   800/ 2001 batches
[2024-04-24 21:41:19.284541]: text ppl 4.1160 | rating loss 0.2643 |  1000/ 2001 batches
[2024-04-24 21:41:39.110390]: text ppl 4.1774 | rating loss 0.2641 |  1200/ 2001 batches
[2024-04-24 21:41:58.924453]: text ppl 4.2655 | rating loss 0.2583 |  1400/ 2001 batches
[2024-04-24 21:42:18.648572]: text ppl 4.3327 | rating loss 0.2553 |  1600/ 2001 batches
[2024-04-24 21:42:38.432714]: text ppl 4.3943 | rating loss 0.2527 |  1800/ 2001 batches
[2024-04-24 21:42:58.204449]: text ppl 4.4900 | rating loss 0.2478 |  2000/ 2001 batches
[2024-04-24 21:42:58.236675]: text ppl 4.9516 | rating loss 0.1431 |  2001/ 2001 batches
[2024-04-24 21:43:05.400585]: text ppl 32.7445 | rating loss 1.4292 | valid loss 4.9179 on validation
weight[0]: 1.1514397859573364
weight[1]: 0.6496253609657288
[2024-04-24 21:43:06.482208]: epoch 9
[2024-04-24 21:43:26.210749]: text ppl 3.2900 | rating loss 0.3953 |   200/ 2001 batches
[2024-04-24 21:43:45.803601]: text ppl 3.4730 | rating loss 0.3913 |   400/ 2001 batches
[2024-04-24 21:44:05.415431]: text ppl 3.5878 | rating loss 0.3845 |   600/ 2001 batches
[2024-04-24 21:44:25.040130]: text ppl 3.7020 | rating loss 0.3755 |   800/ 2001 batches
[2024-04-24 21:44:44.806310]: text ppl 3.7759 | rating loss 0.3618 |  1000/ 2001 batches
[2024-04-24 21:45:04.578457]: text ppl 3.8659 | rating loss 0.3648 |  1200/ 2001 batches
[2024-04-24 21:45:24.342986]: text ppl 3.9375 | rating loss 0.3515 |  1400/ 2001 batches
[2024-04-24 21:45:44.103938]: text ppl 4.0040 | rating loss 0.3430 |  1600/ 2001 batches
[2024-04-24 21:46:03.903231]: text ppl 4.0669 | rating loss 0.3415 |  1800/ 2001 batches
[2024-04-24 21:46:23.672829]: text ppl 4.1265 | rating loss 0.3359 |  2000/ 2001 batches
[2024-04-24 21:46:23.706941]: text ppl 4.4472 | rating loss 0.2979 |  2001/ 2001 batches
[2024-04-24 21:46:30.874985]: text ppl 37.8079 | rating loss 1.3262 | valid loss 4.9588 on validation
weight[0]: 1.1259794235229492
weight[1]: 0.705804169178009
[2024-04-24 21:46:30.875169]: Endured 3 time(s)
[2024-04-24 21:46:30.875183]: epoch 10
[2024-04-24 21:46:50.644804]: text ppl 3.0553 | rating loss 0.2764 |   200/ 2001 batches
[2024-04-24 21:47:10.332820]: text ppl 3.2214 | rating loss 0.2628 |   400/ 2001 batches
[2024-04-24 21:47:30.027759]: text ppl 3.3417 | rating loss 0.2603 |   600/ 2001 batches
[2024-04-24 21:47:49.686932]: text ppl 3.4337 | rating loss 0.2539 |   800/ 2001 batches
[2024-04-24 21:48:09.384068]: text ppl 3.5035 | rating loss 0.2556 |  1000/ 2001 batches
[2024-04-24 21:48:29.083512]: text ppl 3.5924 | rating loss 0.2454 |  1200/ 2001 batches
[2024-04-24 21:48:48.749097]: text ppl 3.6579 | rating loss 0.2447 |  1400/ 2001 batches
[2024-04-24 21:49:08.514593]: text ppl 3.7244 | rating loss 0.2423 |  1600/ 2001 batches
[2024-04-24 21:49:28.307261]: text ppl 3.7895 | rating loss 0.2370 |  1800/ 2001 batches
[2024-04-24 21:49:48.016267]: text ppl 3.8525 | rating loss 0.2316 |  2000/ 2001 batches
[2024-04-24 21:49:48.047250]: text ppl 3.7640 | rating loss 0.1037 |  2001/ 2001 batches
[2024-04-24 21:49:55.212275]: text ppl 42.8100 | rating loss 1.2685 | valid loss 5.0253 on validation
weight[0]: 1.1107147932052612
weight[1]: 0.6325308680534363
[2024-04-24 21:49:55.212484]: Endured 4 time(s)
[2024-04-24 21:49:55.212499]: epoch 11
[2024-04-24 21:50:15.148678]: text ppl 2.8660 | rating loss 0.3394 |   200/ 2001 batches
[2024-04-24 21:50:34.920901]: text ppl 3.0164 | rating loss 0.3338 |   400/ 2001 batches
[2024-04-24 21:50:54.623934]: text ppl 3.1339 | rating loss 0.3274 |   600/ 2001 batches
[2024-04-24 21:51:14.383206]: text ppl 3.2051 | rating loss 0.3192 |   800/ 2001 batches
[2024-04-24 21:51:34.170365]: text ppl 3.2902 | rating loss 0.3143 |  1000/ 2001 batches
[2024-04-24 21:51:53.945738]: text ppl 3.3563 | rating loss 0.3020 |  1200/ 2001 batches
[2024-04-24 21:52:13.697087]: text ppl 3.4253 | rating loss 0.3012 |  1400/ 2001 batches
[2024-04-24 21:52:33.464470]: text ppl 3.4860 | rating loss 0.2893 |  1600/ 2001 batches
[2024-04-24 21:52:53.250573]: text ppl 3.5337 | rating loss 0.2857 |  1800/ 2001 batches
[2024-04-24 21:53:12.924708]: text ppl 3.5955 | rating loss 0.2896 |  2000/ 2001 batches
[2024-04-24 21:53:12.961572]: text ppl 3.3663 | rating loss 0.2887 |  2001/ 2001 batches
[2024-04-24 21:53:20.122871]: text ppl 45.9880 | rating loss 1.1992 | valid loss 5.0276 on validation
weight[0]: 1.0887352228164673
weight[1]: 0.6734762787818909
[2024-04-24 21:53:20.123067]: Endured 5 time(s)
[2024-04-24 21:53:20.123081]: Cannot endure it anymore | Exiting from early stop
=========================================================================================
[2024-04-24 21:53:27.555304]: text ppl 33.3311 | rating loss 1.4414 on test | End of training
[2024-04-24 21:53:27.555423]: Generating text
[2024-04-24 21:54:44.619505]: RMSE  1.2001
[2024-04-24 21:54:44.627111]: MAE  0.9995
[2024-04-24 21:55:01.496019]: BLEU-1 14.1991
[2024-04-24 21:55:04.290325]: BLEU-4  0.8845
[2024-04-24 21:56:14.044673]: USR  0.6436 | USN   20597
[2024-04-24 21:59:41.664391]: DIV  1.9239
[2024-04-24 21:59:42.146610]: FCR  0.5708
[2024-04-24 21:59:42.166499]: FMR  0.0622
[2024-04-24 21:59:46.349796]: rouge_1/f_score 15.0690
[2024-04-24 21:59:46.349916]: rouge_1/r_score 14.7323
[2024-04-24 21:59:46.349928]: rouge_1/p_score 18.1944
[2024-04-24 21:59:46.349938]: rouge_2/f_score  1.7622
[2024-04-24 21:59:46.349945]: rouge_2/r_score  1.7817
[2024-04-24 21:59:46.349953]: rouge_2/p_score  2.1218
[2024-04-24 21:59:46.349960]: rouge_l/f_score 11.8061
[2024-04-24 21:59:46.349967]: rouge_l/r_score 13.3570
[2024-04-24 21:59:46.349974]: rouge_l/p_score 15.8277
[2024-04-24 21:59:46.373569]: Generated text saved to (/root/autodl-tmp/poetry/pepler/pe/tripadvisor/3/generated.txt)
